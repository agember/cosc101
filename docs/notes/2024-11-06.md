# Files: writing; CSV
_COSC 101, Introduction to Computing I, 2024-11-06_

## Announcements
* Revisions to up to two parts from Homework 3 and/or 4 due tomorrow @ 11:59pm
* Exam 2 reattempts Friday during class

## Warm-up

_Write a function called `odd_lines` that takes the name of a file and returns a list containing the 1st, 3rd, 5th, etc. line of the file._


```python
# Create file
with open('warm-up.txt', 'w') as myfile:
    myfile.write('First\nSecond\nThird\nFourth\nFifth\nSixth\n')
```


```python
def odd_lines(filename):
    '''
    Construct a list containing the 1st, 3rd, 5th, etc. line of the file
    
    >>> odd_lines('warm-up.txt')
    ['First\\n', 'Third\\n', 'Fifth\\n']
    '''
    infile = open(filename, 'r')
    line = infile.readline() # Read first line
    lines = []
    while line != '': # Repeat until end of file
        lines = lines + [line]
        line = infile.readline() # Skip a line
        line = infile.readline()
    infile.close()
    return lines
```

<p style="height:20em;"></p>

## Writing files

* What does a program need to do to write data to a file?
    * Open the file in write mode
    * Call the `write` function on the file object
    * Call the `close` function on the file object


```python
myfile = open('myfile.txt', 'w')
myfile.write('Hello, file!\n')
myfile.close()
```

* You must explicitly include newline characters in the string passed to write if you want the next string you write to appear on the next line of the file
    * write **does not** automatically include newlines like print does
* If you do not call close, part of the data may be lost
    * Python stores data in a temporary buffer before writing it to the file; close ensures all data in the buffer is added to the file

<p style="height:25em;"></p>

## Debugging file reading/writing

Assume the file `months.txt` contains the following data:
```
January
February
March
April
May
June
July
August
September
October
November
December
```


```python
# Run this code cell to create months.txt
with open('months.txt', 'w') as months:
    months.write('January\nFebruary\nMarch\nApril\nMay\nJune\nJuly\nAugust\nSeptember\nOctober\nNovember\nDecember\n')
```

*Identify and correct the error(s) in each of the following functions.*


```python
def print_file() -> None:
    """Print the contents of the file"""
    months = open('months.txt', 'r')
    for line in months:
        print(line)
print_file()
```

    January
    
    February
    
    March
    
    April
    
    May
    
    June
    
    July
    
    August
    
    September
    
    October
    
    November
    
    December
    



```python
# CORRECTED
def print_file() -> None:
    """Print the contents of the file"""
    months = open('months.txt', 'r')
    for line in months:
        print(line.strip()) # Need to strip newline to avoid extra blank lines
    months.close() # Need to close file
print_file()
```

    January
    February
    March
    April
    May
    June
    July
    August
    September
    October
    November
    December


<p style="height:10em;"></p>


```python
def print_character_counts() -> None:
    """Print the number of characters in each month"""
    months = open('months.txt', 'r')
    while months.readline() != '':
        line = months.readline()
        print(len(line))
    months.close()
print_character_counts()
```

    9
    6
    5
    7
    8
    9



```python
# CORRECTED
def print_character_counts() -> None:
    """Print the number of characters in each month"""
    months = open('months.txt', 'r')
    line = months.readline() # Priming read
    while line != '': # Check if previously read line was empty
        print(len(line))
        line = months.readline() # Read next line
    months.close()
print_character_counts()
```

    8
    9
    6
    6
    4
    5
    5
    7
    10
    8
    9
    9


<p style="height:10em;"></p>


```python
def store_line_count() -> None:
    """Store the number of lines in months.txt in a new file called count.txt"""
    months = open('months.txt', 'w')
    data = months.read()
    months.close()
    size = open('size.txt', 'w')
    size.write('lines: '+str(len(data)))
    size.close()
store_line_count()
```


    ---------------------------------------------------------------------------

    UnsupportedOperation                      Traceback (most recent call last)

    Cell In[12], line 9
          7     size.write('lines: '+str(len(data)))
          8     size.close()
    ----> 9 store_line_count()


    Cell In[12], line 4, in store_line_count()
          2 """Store the number of lines in months.txt in a new file called count.txt"""
          3 months = open('months.txt', 'w')
    ----> 4 data = months.read()
          5 months.close()
          6 size = open('size.txt', 'w')


    UnsupportedOperation: not readable



```python
# CORRECTED
def store_line_count() -> None:
    """Store the number of lines in months.txt in a new file called count.txt"""
    months = open('months.txt', 'r') # Open file for reading
    data = months.readlines() # Get a list of lines
    months.close()
    size = open('size.txt', 'w')
    size.write('lines: '+str(len(data)))
    size.close()
store_line_count()
```

<p style="height:10em;"></p>

## CSV files

* A comma-separated variable (CSV) file is often used to store data
* Each line in a CSV file is like a row in a table (or spreadsheet)
* A comma (`,`) is used to delineate the values (or columns) within each line (or row)
* The first line of the file usually contains column names

Assume the file `people.csv` contains the following data on notable computer scientists:
```
LastName,FirstName,KnownFor
Johnson,Katherine,was a "human computer" at NASA
Dean,Mark,co-created the IBM personal computer
Berners-Lee,Tim,invented the World Wide Web
Hopper,Grace,found the first computer bug
```


```python
# Run this code cell to create people.csv
with open('people.csv', 'w') as people:
    people.write("""LastName,FirstName,KnownFor\nJohnson,Katherine,was a "Human computer" at NASA\nDean,Mark,co-created the IBM personal computer\nBerners-Lee,Tim,invented the World Wide Web\nHopper,Grace,found the first computer bug""")
```

* Use `readline()` to read the first line containing the column names
* Use `strip()` to remove the "trailing newline"
* Use `split(',')` to convert a line into a list of values


```python
people = open('people.csv', 'r')
first = people.readline()
first = first.strip()
column_names = first.split(',')
print(column_names)
```

    ['LastName', 'FirstName', 'KnownFor']


* Use for loop to iterate through lines (or rows) of data
* Again, use `strip` and `split`
* Use indexing or slicing to access specific values


```python
for line in people:
    values = line.strip().split(',')
    print(values[1],values[0],values[2])
```

    Katherine Johnson was a "Human computer" at NASA
    Mark Dean co-created the IBM personal computer
    Tim Berners-Lee invented the World Wide Web
    Grace Hopper found the first computer bug


* Remember to close the file!


```python
people.close()
```

* Instead of using `readline` and a for loop, you can use `readlines` with indexing, slicing, and a for loop


```python
people = open('people.csv', 'r')
lines = people.readlines()
people.close()

first = lines[0].strip()
column_names = first.split(',')
print(column_names)
for line in lines[1:]:
    values = line.strip().split(',')
    print(values[1],values[0],values[2])
```

    ['LastName', 'FirstName', 'KnownFor']
    Katherine Johnson was a "Human computer" at NASA
    Mark Dean co-created the IBM personal computer
    Tim Berners-Lee invented the World Wide Web
    Grace Hopper found the first computer bug


<p style="height:28em;"></p>

## Extra practice

*What is the contents of `seasons.txt` after the program has finished?*


```python
def main() -> None:
    seasons = [['Winter', 'cold', 'snowy'], 
               ['Spring', 'warm', 'rainy'], 
               ['Summer', 'hot', 'sunny'], 
               ['Autumn', 'cool', 'windy']]
    outfile = open('seasons.txt', 'w')
    outfile.write('In Hamilton:\n')
    for season in seasons:
        outfile.write(season[0] + ' is...')
        outfile.write(' and '.join(season[1:]) + '\n')
    outfile.close()
main()
```

```
In Hamilton:
Winter is...cold and snowy
Spring is...warm and rainy
Summer is...hot and sunny
Autumn is...cool and windy
```

<p style="height:10em;"></p>


```python
import doctest
doctest.testmod()
```




    TestResults(failed=0, attempted=1)


